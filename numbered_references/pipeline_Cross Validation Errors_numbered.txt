 1| import sys
 2| import os
 3| from sklearn.model_selection import train_test_split, cross_val_score
 4| from sklearn.feature_selection import SelectKBest, f_classif
 5| from sklearn.ensemble import RandomForestClassifier
 6| from imblearn.under_sampling import RandomUnderSampler
 7| import pandas as pd
 8| 
 9| current_dir = os.path.dirname(os.path.abspath(__file__))
10| parent_dir = os.path.dirname(current_dir)
11| sys.path.append(parent_dir)
12| 
13| from utils import get_project_root
14| 
15| project_root = get_project_root()
16| 
17| raw_data_file = os.path.join(project_root, "datasets", "diabetes_indicator", "5050_split.csv")
18| data = pd.read_csv(raw_data_file)
19| 
20| rus = RandomUnderSampler(random_state=42)
21| X_resampled, y_resampled = rus.fit_resample(data.drop('Diabetes_binary', axis=1), data['Diabetes_binary'])
22| 
23| selector = SelectKBest(f_classif, k=10)
24| X_selected = selector.fit_transform(X_resampled, y_resampled)
25| 
26| clf = RandomForestClassifier(random_state=42)
27| scores = cross_val_score(clf, X_selected, y_resampled, cv=5)
28| 
29| print("Cross-validation scores:", scores)
30| 